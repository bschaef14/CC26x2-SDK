

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flash Layout for Off-Chip OAD &mdash; 
SimpleLink™ CC13x2 / CC26x2 SDK
Thread User&#39;s Guide
 1.08.01.00 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OAD Image Tool" href="tools.html" />
    <link rel="prev" title="OAD External Flash Image Header" href="ext-flash-image-header.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug oad-secure flash-layout-off-chip";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for TI beyond RTD Sphinx Theme --->
<div class="DocSite-globalNav tiNav">
    <ul>
    </ul>
</div>

<a class="DocSite-nav" href="https://www.ti.com" style="padding-bottom: 85px;">
  <img class="DocSiteNav-logo"
    src="../_static/img/ti_logo.png"
    alt="TI Logo">
  <div class="DocSiteNav-title"></div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../thread-guide/index-cc13x2_26x2.html" class="icon icon-home" alt="Documentation Home"> 
SimpleLink™ CC13x2 / CC26x2 SDK
Thread User's Guide

          

          
          </a>

          
            
            
              <div class="version">
                1.08.01.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13x2_26x2.html">Introduction to the SimpleLink CC13x2 / 26x2 SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/ti-openthread-intro.html">TI-OpenThread Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/platform-cc13x2_26x2.html">SimpleLink CC13x2_26x2 SDK Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/software-development-index.html">Developing Thread Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/thread-protocol.html">Thread Networking Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13x2_26x2/custom-hardware-cc13x2_26x2.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/packet-sniffer-index.html">Packet Sniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/border-router-index.html">Linux Border Router Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../thread-guide/oad-index.html">Over-the-Air Download (OAD)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="oad-types.html">OAD Storage &amp; Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="bim.html">Boot Image Manager (BIM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bim-off-chip.html">BIM for Off-Chip OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="image-header.html">OAD Image Header</a></li>
<li class="toctree-l2"><a class="reference internal" href="ext-flash-image-header.html">OAD External Flash Image Header</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Flash Layout for Off-Chip OAD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constraints-and-requirements-for-off-chip-oad">Constraints and Requirements for Off-chip OAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#internal-flash-memory-layout">Internal Flash Memory Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#external-flash-memory-layout">External Flash Memory Layout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">OAD Image Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/native-oad.html">TI-OpenThread Native OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/non-native-oad.html">Non-native OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/create-tiop-oad-image.html">Create a TI-OpenThread OAD Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/migration-index.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/glossary.html">Terms and Definitions</a></li>
</ul>

            
          
          <!-- extra nav elements for TI beyond RTD Sphinx Theme --->
<div id="sideBanner">
    <br/>
    <br/><br/><br/>
</div>
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../thread-guide/index-cc13x2_26x2.html">
SimpleLink™ CC13x2 / CC26x2 SDK
Thread User's Guide
</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../thread-guide/index-cc13x2_26x2.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../thread-guide/oad-index.html">Over-the-Air Download (OAD)</a> &raquo;</li>
        
      <li>Flash Layout for Off-Chip OAD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flash-layout-for-off-chip-oad">
<span id="sec-oad-flash-layout-off-chip"></span><h1>Flash Layout for Off-Chip OAD<a class="headerlink" href="#flash-layout-for-off-chip-oad" title="Permalink to this headline">¶</a></h1>
<p>This section will describe the method for placing images in internal and
external flash when using off-chip OAD.</p>
<p>Internal flash refers to the flash memory inside the CC13x2 or CC26x2 and external
flash refers to an external SPI flash memory connected to the CC13x2 or CC26x2 via SPI.</p>
<p>See requirements below for off-chip OAD.</p>
<div class="section" id="constraints-and-requirements-for-off-chip-oad">
<h2>Constraints and Requirements for Off-chip OAD<a class="headerlink" href="#constraints-and-requirements-for-off-chip-oad" title="Permalink to this headline">¶</a></h2>
<p>In order to perform an Off-chip OAD the target system must have:</p>
<blockquote>
<div><ul class="simple">
<li>An off-chip flash storage as large as the application size + one
external flash page to store the external flash image header. (default example
will use 1MB of external flash)</li>
<li>A serial connection (SPI) is used to communicate with the off-chip flash
component.</li>
<li>Free GPIO pins to interface to the external memory (i.e. 4 wires for SPI)</li>
<li>Enough free code space to reserve the entire contents of the last 1-2 flash
page(s) for BIM</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="internal-flash-memory-layout">
<span id="sect-off-chip-bim-memory-layout"></span><h2>Internal Flash Memory Layout<a class="headerlink" href="#internal-flash-memory-layout" title="Permalink to this headline">¶</a></h2>
<p>The internal flash of the device contains the active user application and the
BIM. Off-chip OAD maximizes the available flash space to the user
application because of its ability to store the incoming image in external flash
during the download process.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using security the BIM may use a second page depending on the
page size of the device. Consult the BIM’s linker file for more information.</p>
</div>
<img alt="../_images/ditaa-de348287e375596e470877a22388ab8714f9f363.png" src="../_images/ditaa-de348287e375596e470877a22388ab8714f9f363.png" />
<p>The user application pictured above is responsible for the following:</p>
<blockquote>
<div><ul class="simple">
<li>Implementing the protocol stack specific implementation of the OAD
transport</li>
<li>Finding a suitable location in external flash for the image and storing
its image header in the table.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="external-flash-memory-layout">
<span id="sec-ext-flash-layout"></span><h2>External Flash Memory Layout<a class="headerlink" href="#external-flash-memory-layout" title="Permalink to this headline">¶</a></h2>
<p>The off-chip flash memory on the CC13x2 or CC26x2 LaunchPad contains the image header vector
table and the user applications. The memory map layout of the external flash
part is defined in <code class="code docutils literal notranslate"><span class="pre">ext_flash_layout.h</span></code>.
The amount of space reserved for each application is dynamically* sized by the
user application’s implementation of the OAD protocol. The size of the image in
external flash can be determined once the image header vector is sent over the
air.</p>
<p>The application will round up as necessary according to the equation below:</p>
<div class="math">
<p><img src="../_images/math/cd91554cf4cccf881bc83c75c8763a6a3d353f2a.svg" alt="\textrm{numExtFlashPages} = \frac{imageLen}{EFL\_PAGE\_SIZE} + imageLen \bmod EFL\_PAGE\_SIZE"/></p>
</div><p>The memory partition of the application for Off-chip OAD is depicted in
below.</p>
<img alt="../_images/ditaa-241a5fd66797ea5862cc39bf3b386f85edf75483.png" src="../_images/ditaa-241a5fd66797ea5862cc39bf3b386f85edf75483.png" />
<p>The size of the image header table is scalable and can be changed in the
user application implementation of the OAD protocol.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The CC2640R2 SDK applications take a simplistic approach to external flash
layout, partioning the variable space in external flash into two sectors</p>
<blockquote>
<div><ul class="simple">
<li>Sector 0: used for all app images and is 128kB
(matching device size for CC2640R2)</li>
<li>Sector 1: used for app+stack and other image types, also 128kB</li>
<li>The max number of metadata is capped at 4.</li>
</ul>
</div></blockquote>
<p class="last">Other definitons can be found in <code class="docutils literal notranslate"><span class="pre">ext_flash_layout.h</span></code>.</p>
</div>
<p>Each entry to the image header table contains a pointer to it’s associated image
location in external flash as shown below.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The convention is that image header sector 0 is reserved for the
<a class="reference internal" href="../thread/glossary.html#term-factory-image"><span class="xref std std-term">Factory Image</span></a>. This region should be reserved for known good images
as the BIM will revert to the factory image if there are no
acceptable images in internal or external flash (user section).</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tools.html" class="btn btn-neutral float-right" title="OAD Image Tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ext-flash-image-header.html" class="btn btn-neutral float-left" title="OAD External Flash Image Header" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        <a href="https://www.ti.com/corp/docs/legal/copyright.shtml">2016-2019, Texas Instruments</a>, Texas Instruments Incorporated. All rights reserved. <br>
        <a href="https://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="https://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="https://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="https://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>